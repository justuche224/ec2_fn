import{r,j as e,B as v,aY as w}from"./index-BVlH3n0h.js";import{d as E,u as b}from"./paypal-HHWK-B4W.js";import{D as A,f as S,a as L,b as R,c as F,d as U,e as I}from"./dialog-DFNuYmcJ.js";import{I as T}from"./input-B1UDhOgi.js";import{L as a}from"./label-Dndy2xtm.js";import{F as B,a as O}from"./form-success-B0W-83Lj.js";import{B as j}from"./badge-CiDXrPHU.js";import{C as g,a as N,b as y,d as P,c as $,e as k}from"./card-Cn1464GL.js";import{L as G}from"./loader-circle-CnBdTBbm.js";import"./circle-alert-Cnr54O0J.js";import"./check-BGrFiPcB.js";const H="https://api.ecohavest.org/api/deposit/paypal/images/",V=({paypalId:l})=>{const[s,d]=r.useState(null),[o,c]=r.useState(!0),[m,n]=r.useState(null),x=async()=>{c(!0),n(null);try{const t=await E(l);d(t)}catch(t){n(t instanceof Error?t.message:"Failed to fetch deposit details.")}finally{c(!1)}};r.useEffect(()=>{x()},[l]);const i=t=>new Date(t).toLocaleString(),p=t=>`$${parseFloat(t).toFixed(2)}`,u=t=>{switch(t){case"APPROVED":case"ACTIVE":case"COMPLETED":return e.jsx(j,{className:"bg-green-500 text-white px-3 py-1 text-sm",children:t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()});case"REJECTED":case"FAILED":case"CANCELLED":return e.jsx(j,{variant:"destructive",className:"px-3 py-1 text-sm",children:t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()});case"PROCESSING":return e.jsx(j,{className:"bg-blue-500 text-white px-3 py-1 text-sm",children:t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()});default:return e.jsx(j,{variant:"outline",className:"bg-yellow-100 text-yellow-800 px-3 py-1 text-sm",children:t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()})}};return o?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(G,{className:"animate-spin text-primary",size:40})}):m?e.jsxs(g,{className:"max-w-2xl mx-auto mt-8",children:[e.jsx(N,{children:e.jsx(y,{className:"text-red-500",children:"Error"})}),e.jsxs(P,{children:[e.jsx("p",{children:m}),e.jsx(v,{onClick:x,className:"mt-4",children:"Try Again"})]})]}):s?e.jsx("div",{className:"container mx-auto py-6 md:w-[90%] lg:w-[70%] px-4",children:e.jsxs(g,{className:"w-full",children:[e.jsx(N,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(y,{className:"text-2xl font-bold mb-1",children:"PayPal Deposit Details"}),e.jsxs($,{children:["Transaction ID: ",s.id]})]}),u(s.status)]})}),e.jsxs(P,{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Amount"}),e.jsx("p",{className:"text-lg font-semibold",children:p(s.amount)})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"PayPal Email"}),e.jsx("p",{className:"text-lg",children:s.paypalEmail})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"PayPal Name"}),e.jsx("p",{className:"text-lg",children:s.paypalName||"N/A"})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Date Created"}),e.jsx("p",{className:"text-lg",children:i(s.createdAt)})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Last Updated"}),e.jsx("p",{className:"text-lg",children:i(s.updatedAt)})]}),s.approvedAt&&e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Approved At"}),e.jsx("p",{className:"text-lg",children:i(s.approvedAt)})]}),s.rejectedAt&&e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Rejected At"}),e.jsx("p",{className:"text-lg",children:i(s.rejectedAt)})]})]}),s.rejectionReason&&e.jsxs("div",{className:"mt-2",children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Rejection Reason"}),e.jsx("p",{className:"text-lg text-red-600",children:s.rejectionReason})]}),s.paymentProof&&e.jsxs("div",{className:"mt-2",children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Payment Proof"}),e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:`${H}${s.paymentProof}`,alt:"Payment proof",className:"max-w-xs rounded-lg border shadow-md"})})]})]}),e.jsx(k,{className:"flex justify-end",children:s.status==="PENDING"&&e.jsx(_,{paypalId:l})})]})}):e.jsxs(g,{className:"max-w-2xl mx-auto mt-8",children:[e.jsx(N,{children:e.jsx(y,{children:"Not Found"})}),e.jsx(P,{children:e.jsx("p",{children:"Deposit details could not be found."})})]})},_=({paypalId:l})=>{const[s,d]=r.useState(null),[o,c]=r.useState(),[m,n]=r.useState(),[x,i]=r.useState(),[p,u]=r.useState(!1);async function t(){if(!s){n("Please upload a proof of payment");return}u(!0),n(void 0),i(void 0);try{await b(l,s),i("Payment proof uploaded successfully"),window.location.reload()}catch(h){n(h instanceof Error?h.message:"An error occurred")}finally{u(!1)}}r.useEffect(()=>()=>{o&&URL.revokeObjectURL(o)},[o]);const D=h=>{var C;const f=(C=h.target.files)==null?void 0:C[0];f?(d(f),c(URL.createObjectURL(f))):(d(null),c(void 0))};return e.jsxs(A,{children:[e.jsx(S,{asChild:!0,children:e.jsx(v,{children:"Upload Payment Proof"})}),e.jsxs(L,{children:[e.jsxs(R,{children:[e.jsx(F,{children:"Upload Payment Proof"}),e.jsx(U,{children:"Please upload a screenshot or image of your payment confirmation."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(a,{htmlFor:"payment-proof",className:"text-right",children:"Screenshot"}),e.jsx(T,{id:"payment-proof",type:"file",accept:"image/*",onChange:D,className:"col-span-3"})]}),o&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx("img",{src:o,alt:"Payment proof preview",className:"max-w-[300px] rounded-lg border"})})]}),e.jsx(B,{message:m}),e.jsx(O,{message:x}),e.jsx(I,{children:e.jsx(v,{onClick:t,"aria-label":"Upload payment proof",type:"submit",disabled:p,children:p?"Submitting...":"Submit"})})]})]})},se=function(){const{paypalId:s}=w.useParams();return e.jsx(V,{paypalId:s})};export{se as component};
