import{e as x,j as e,c as g,aj as X,r as l,B as k,t as F,ak as Y}from"./index-CGurzyVz.js";import{B as c}from"./badge-BZ9A7x-u.js";import{T as ee,a as te,b as C,c as y,d as se,e as j}from"./table-C1SpnW0A.js";import{S as R,a as M,b as _,c as I,d as r}from"./select-CLmzBvK_.js";import{g as ae}from"./stats-B3VkFHdZ.js";import{L as V}from"./loader-circle-PBT_AWw8.js";import{F as ne}from"./filter-Np2RDBjm.js";import{T as re}from"./trending-up-B47Bh0RW.js";import"./index-D3W1_sAd.js";import"./index-DCyx4Rjm.js";import"./chevron-down-DNOW6dRR.js";import"./check-Cmy4B8p9.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],le=x("ArrowDown",ie);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],oe=x("ArrowUp",ce);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],he=x("ChevronLeft",de);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ue=x("ChevronRight",me);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],pe=x("FileDown",xe);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ge=x("RefreshCw",je);function fe({className:s,...a}){return e.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:g("mx-auto flex w-full justify-center",s),...a})}function ve({className:s,...a}){return e.jsx("ul",{"data-slot":"pagination-content",className:g("flex flex-row items-center gap-1",s),...a})}function L({...s}){return e.jsx("li",{"data-slot":"pagination-item",...s})}function T({className:s,isActive:a,size:w="icon",...o}){return e.jsx("a",{"aria-current":a?"page":void 0,"data-slot":"pagination-link","data-active":a,className:g(X({variant:a?"outline":"ghost",size:w}),s),...o})}function Ne({className:s,...a}){return e.jsxs(T,{"aria-label":"Go to previous page",size:"default",className:g("gap-1 px-2.5 sm:pl-2.5",s),...a,children:[e.jsx(he,{}),e.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function ye({className:s,...a}){return e.jsxs(T,{"aria-label":"Go to next page",size:"default",className:g("gap-1 px-2.5 sm:pr-2.5",s),...a,children:[e.jsx("span",{className:"hidden sm:block",children:"Next"}),e.jsx(ue,{})]})}function we({userId:s}){const[a,w]=l.useState([]),[o,A]=l.useState([]),[b,S]=l.useState(!0),[O,$]=l.useState(0),[f,B]=l.useState("ALL"),[p,U]=l.useState("ALL"),[d,v]=l.useState(1),N=10,E=async()=>{try{S(!0);const t=await ae(s);w(t.transactions),A(t.transactions),$(t.total)}catch{F.error("Failed to fetch transaction history")}finally{S(!1)}};l.useEffect(()=>{let t=a;f!=="ALL"&&(t=t.filter(n=>n.status===f)),p!=="ALL"&&(t=t.filter(n=>n.type===p)),A(t),v(1)},[f,p,a]);const D=d*N,q=D-N,P=o.slice(q,D),m=Math.ceil(o.length/N),H=t=>new Date(t).toLocaleString(),z=(t,n)=>`${parseFloat(t).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:8})} ${n}`,G=(t,n)=>{if(n==="investment")switch(t){case"ACTIVE":return e.jsx(c,{className:"bg-green-500",children:"Active"});case"COMPLETED":return e.jsx(c,{className:"bg-blue-500",children:"Completed"});case"CANCELLED":return e.jsx(c,{variant:"destructive",children:"Cancelled"});case"PENDING":return e.jsx(c,{variant:"outline",className:"bg-yellow-100 text-yellow-800",children:"Pending"});default:return e.jsx(c,{variant:"outline",className:"bg-yellow-100 text-yellow-800",children:"Pending"})}switch(t){case"APPROVED":return e.jsx(c,{className:"bg-green-500",children:"Approved"});case"REJECTED":return e.jsx(c,{variant:"destructive",children:"Rejected"});case"FAILED":return e.jsx(c,{className:"bg-gray-500",children:"Failed"});default:return e.jsx(c,{variant:"outline",className:"bg-yellow-100 text-yellow-800",children:"Pending"})}},J=t=>{switch(t){case"deposit":return e.jsx(le,{className:"h-4 w-4 text-green-500"});case"withdrawal":return e.jsx(oe,{className:"h-4 w-4 text-red-500"});case"investment":return e.jsx(re,{className:"h-4 w-4 text-blue-500"});default:return null}},W=()=>{const n=[["Date","Type","Amount","Currency","Status"]];o.forEach(h=>{n.push([new Date(h.createdAt).toLocaleString(),h.type,h.amount,h.currency,h.status])});const i=n.map(h=>h.join(",")).join(`
`),K=new Blob([i],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a"),Q=URL.createObjectURL(K);u.setAttribute("href",Q),u.setAttribute("download",`transactions_${s}_${new Date().toISOString().split("T")[0]}.csv`),u.style.visibility="hidden",document.body.appendChild(u),u.click(),document.body.removeChild(u),F.success("Transaction history exported successfully")},Z=()=>p==="investment"?e.jsxs(e.Fragment,{children:[e.jsx(r,{value:"ALL",children:"All Statuses"}),e.jsx(r,{value:"PENDING",children:"Pending"}),e.jsx(r,{value:"ACTIVE",children:"Active"}),e.jsx(r,{value:"COMPLETED",children:"Completed"}),e.jsx(r,{value:"CANCELLED",children:"Cancelled"})]}):e.jsxs(e.Fragment,{children:[e.jsx(r,{value:"ALL",children:"All Statuses"}),e.jsx(r,{value:"PENDING",children:"Pending"}),e.jsx(r,{value:"APPROVED",children:"Approved"}),e.jsx(r,{value:"REJECTED",children:"Rejected"}),e.jsx(r,{value:"FAILED",children:"Failed"})]});return l.useEffect(()=>{s&&E()},[s]),e.jsx("div",{className:"mx-5 lg:mx-10",children:e.jsxs("div",{className:"bg-sidebar rounded-lg shadow p-6 container mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Transaction History"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(k,{onClick:E,variant:"outline",disabled:b,className:"cursor-pointer",children:[b&&e.jsx(V,{className:"animate-spin h-4 w-4 mr-2"}),e.jsx("span",{children:e.jsx(ge,{className:"h-4 w-4 mr-2 md:hidden"})}),e.jsx("span",{className:"hidden md:inline",children:"Refresh"})]}),e.jsxs(k,{onClick:W,variant:"outline",className:"cursor-pointer",disabled:o.length===0,children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Export CSV"})]})]})]}),e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",o.length," of ",O," transactions"]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2 flex-col lg:flex-row",children:[e.jsx(ne,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(R,{value:p,onValueChange:U,children:[e.jsx(M,{className:"w-[150px]",children:e.jsx(_,{placeholder:"Type"})}),e.jsxs(I,{children:[e.jsx(r,{value:"ALL",children:"All Types"}),e.jsx(r,{value:"deposit",children:"Deposits"}),e.jsx(r,{value:"withdrawal",children:"Withdrawals"}),e.jsx(r,{value:"investment",children:"Investments"})]})]}),e.jsxs(R,{value:f,onValueChange:B,children:[e.jsx(M,{className:"w-[150px]",children:e.jsx(_,{placeholder:"Status"})}),e.jsx(I,{children:Z()})]})]})})]}),b?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(V,{className:"animate-spin",size:40})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ee,{children:[e.jsx(te,{children:e.jsxs(C,{children:[e.jsx(y,{children:"Date"}),e.jsx(y,{children:"Type"}),e.jsx(y,{children:"Amount"}),e.jsx(y,{children:"Status"})]})}),e.jsx(se,{children:P.length===0?e.jsx(C,{children:e.jsx(j,{colSpan:4,className:"text-center py-8",children:a.length===0?"No transactions found":"No transactions match your filter criteria"})}):P.map(t=>e.jsxs(C,{children:[e.jsx(j,{children:H(t.createdAt)}),e.jsx(j,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[J(t.type),e.jsx("span",{className:"capitalize",children:t.type})]})}),e.jsx(j,{className:"font-medium",children:z(t.amount,t.currency)}),e.jsx(j,{children:G(t.status,t.type)})]},t.id))})]})}),o.length>N&&e.jsx(fe,{className:"mt-4",children:e.jsxs(ve,{children:[e.jsx(L,{children:e.jsx(Ne,{onClick:()=>v(t=>Math.max(t-1,1)),className:d===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:Math.min(5,m)},(t,n)=>{let i;return m<=5||d<=3?i=n+1:d>=m-2?i=m-4+n:i=d-2+n,e.jsx(L,{children:e.jsx(T,{onClick:()=>v(i),isActive:d===i,className:"cursor-pointer",children:i})},i)}),e.jsx(L,{children:e.jsx(ye,{onClick:()=>v(t=>Math.min(t+1,m)),className:d===m?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})]})})}const Me=function(){const{user:a}=Y.useLoaderData();return e.jsx(we,{userId:a.id})};export{Me as component};
