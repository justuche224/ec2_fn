import{u as M,r as l,j as e,B as i,L as w,t as V,az as $}from"./index-BVlH3n0h.js";import{A as G,a as J,b as K,c as Q,d as X,e as Z}from"./alert-dialog-Dyup5WPd.js";import{C as N,a as b,b as y,d as g,e as v,c as U}from"./card-Cn1464GL.js";import{a as _}from"./wallets-Dca36v16.js";import{a as ee}from"./withdrawal-DdesQPPb.js";import{L as R}from"./loader-circle-CnBdTBbm.js";import{A as se}from"./arrow-right-2qW5_HpR.js";import{T as ae}from"./triangle-alert-CQZ5V9Z9.js";import{C as te}from"./check-BGrFiPcB.js";function re(d){l.useEffect(()=>{const o=m=>{if(d)return m.preventDefault(),m.returnValue="You have a withdrawal in progress. Are you sure you want to leave?",m.returnValue};return window.addEventListener("beforeunload",o),()=>window.removeEventListener("beforeunload",o)},[d])}const S=({currency:d})=>{switch(d){case"BTC":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-orange-500 flex items-center justify-center text-white font-bold",children:"₿"});case"ETH":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-purple-700 flex items-center justify-center text-white font-bold",children:"Ξ"});case"USDT":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-600 flex items-center justify-center text-white font-bold",children:"₮"});case"SOL":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-bold",children:"◎"});case"BNB":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-yellow-500 flex items-center justify-center text-white font-bold",children:"B"});case"LTC":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-500 flex items-center justify-center text-white font-bold",children:"Ł"});default:return e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-300 flex items-center justify-center",children:"?"})}},ue=function(){const o=M(),[m,C]=l.useState([]),[F,k]=l.useState(!0),[A,h]=l.useState(null),[u,f]=l.useState("select-currency"),[t,z]=l.useState(null),[n,B]=l.useState(""),[c,H]=l.useState({}),[j,D]=l.useState(""),[T,L]=l.useState(!1),[O,p]=l.useState(!1),[Y,q]=l.useState([]);re(u==="enter-details"&&n!==""),l.useEffect(()=>{(async()=>{try{k(!0);const a=await $();H(a);const r=await _();!r||Array.isArray(r)&&r.length===0?C([]):Array.isArray(r)?C(r):C([r]),q(["BTC","ETH","USDT","SOL","BNB","LTC"])}catch(a){h("Failed to load withdrawal data. Please try again later."),console.error(a)}finally{k(!1)}})()},[]);const P=s=>{z(s),f("enter-details")},E=s=>m.find(a=>a.currency===s)||null,I=async()=>{if(!t||!n||isNaN(parseFloat(n))||!j){h("Please fill all required fields");return}const s=parseFloat(n),a=parseFloat(c[t]||"0");if(s>a){h(`Withdrawal amount exceeds your available ${t} balance`);return}try{L(!0),await ee(t,s,j),f("confirmation")}catch(r){h("Failed to process your withdrawal. Please try again."),console.error(r)}finally{L(!1)}},x=(s,a)=>{const r=parseFloat(s);return isNaN(r)?"0":a==="BTC"?r.toFixed(8):a==="ETH"?r.toFixed(6):a==="SOL"||a==="BNB"||a==="LTC"?r.toFixed(4):r.toFixed(2)},W=Y.filter(s=>parseFloat(c[s]||"0")>0);if(F)return e.jsx("div",{className:"flex h-full min-h-96 items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(R,{className:"mx-auto h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"mt-2 text-lg",children:"Loading withdrawal options..."})]})});if(A)return e.jsx("div",{className:"flex h-full min-h-96 items-center justify-center",children:e.jsxs(N,{className:"w-full max-w-md",children:[e.jsx(b,{className:"bg-red-50 text-red-700",children:e.jsx(y,{children:"Error"})}),e.jsx(g,{className:"pt-6",children:e.jsx("p",{children:A})}),e.jsx(v,{children:e.jsx(i,{onClick:()=>window.location.reload(),children:"Try Again"})})]})});if(W.length===0&&!F&&!A)return e.jsxs("div",{className:"container py-8 mx-auto text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Withdraw Funds via Crypto Wallet"}),e.jsx("p",{className:"text-xl text-gray-600 text-center",children:"You currently have no crypto balances to withdraw."}),e.jsxs("p",{className:"mt-4",children:[e.jsx(w,{to:"/dashboard/deposit",className:"text-primary hover:underline",children:"Deposit funds"})," ","or"," ",e.jsx(w,{to:"/dashboard",className:"text-primary hover:underline",children:"return to dashboard"}),"."]})]});if(u==="select-currency")return e.jsxs("div",{className:"container py-8 mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Withdraw Funds via Crypto Wallet"}),e.jsxs("div",{className:"max-w-lg mx-auto mb-8 bg-blue-50 text-black p-4 rounded-lg",children:[e.jsx("h2",{className:"text-xl font-bold mb-3",children:"Available Balances"}),e.jsx("div",{className:"space-y-2",children:W.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{currency:s}),e.jsx("span",{className:"ml-2 font-medium",children:s})]}),e.jsxs("div",{className:"font-bold",children:[x(c[s]||"0",s)," ",s]})]},s))})]}),e.jsx("p",{className:"text-gray-600 mb-8 text-center",children:"Select the cryptocurrency you wish to withdraw:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl mx-auto",children:W.map(s=>{const a=E(s);return e.jsxs(N,{className:`hover:shadow-md transition-shadow ${a?"cursor-pointer":"opacity-75"}`,onClick:()=>a&&P(s),children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(S,{currency:s}),e.jsx(y,{children:s})]})}),e.jsxs(g,{children:[e.jsxs(U,{children:["Balance:"," ",x(c[s]||"0",s)," ",s]}),a?e.jsxs("p",{className:"text-xs text-gray-500 mt-2 truncate",children:["Wallet: ",a.address.substring(0,10),"...",a.address.substring(a.address.length-10)]}):e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["No ",s," wallet address added"]})]}),e.jsx(v,{className:"pt-0",children:a?e.jsxs(i,{variant:"ghost",className:"ml-auto",size:"sm",children:["Withdraw ",e.jsx(se,{className:"ml-2 h-4 w-4"})]}):a?e.jsx(w,{to:"/dashboard/account/wallet",search:{callbackURL:"/dashboard/withdraw/"},className:"ml-auto",children:e.jsx(i,{variant:"outline",size:"sm",className:"cursor-pointer",children:"Add Wallet"})}):e.jsx(w,{to:"/dashboard/account/wallet",search:{callbackURL:"/dashboard/withdraw/"},className:"ml-auto",children:e.jsx(i,{variant:"outline",size:"sm",className:"cursor-pointer",children:"Add Wallet"})})})]},s)})})]});if(u==="enter-details"&&t){const s=E(t),a=parseFloat(c[t]||"0");return e.jsxs("div",{className:"container py-8 mx-auto",children:[e.jsxs("h1",{className:"text-3xl font-bold mb-6",children:["Withdraw ",t]}),e.jsxs(N,{className:"max-w-lg mx-auto",children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center",children:[e.jsx(S,{currency:t}),e.jsxs("span",{className:"ml-2",children:[t," Withdrawal"]})]}),e.jsxs(U,{children:["Available balance:"," ",x(c[t]||"0",t)," ",t]})]}),e.jsxs(g,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"amount",className:"block text-sm font-medium",children:["Amount to Withdraw (in ",t,")"]}),e.jsx("div",{className:"relative mt-1 rounded-md shadow-sm",children:e.jsx("input",{id:"amount",type:"number",placeholder:"0.00",className:"w-full p-2 border rounded",value:n,onChange:r=>B(r.target.value),step:t==="BTC"?"0.00000001":"0.000001",min:"0",max:a})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Maximum:"," ",x(c[t]||"0",t)," ",t]}),e.jsx(i,{variant:"link",size:"sm",className:"text-xs p-0 h-auto",onClick:()=>B(a.toString()),children:"Use Max"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium",children:"Destination Address"}),e.jsx("input",{id:"address",type:"text",placeholder:`Enter your ${t} address`,className:"w-full p-2 border rounded font-mono text-xs sm:text-sm",value:j,onChange:r=>D(r.target.value)}),s&&e.jsxs(i,{variant:"outline",size:"sm",className:"w-full mt-1",onClick:()=>{D(s.address),V.success("Address copied from your saved wallet")},children:["Use My Saved ",t," Wallet Address"]})]}),e.jsx("div",{className:"rounded-md bg-amber-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ae,{className:"h-5 w-5 text-amber-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-amber-800",children:"Important Notes"}),e.jsx("div",{className:"mt-2 text-sm text-amber-700",children:e.jsxs("ul",{className:"list-disc space-y-1 pl-5",children:[e.jsx("li",{children:"Withdrawals are processed within 24 hours"}),e.jsx("li",{children:"Network fees will be deducted from your withdrawal amount"}),e.jsx("li",{children:"Double-check your withdrawal address - funds sent to incorrect addresses cannot be recovered"})]})})]})]})})]}),e.jsxs(v,{className:"flex justify-between",children:[e.jsx(i,{variant:"outline",onClick:()=>{n&&parseFloat(n)>0?p(!0):f("select-currency")},children:"Back"}),e.jsx(i,{className:"cursor-pointer",onClick:I,disabled:!n||isNaN(parseFloat(n))||parseFloat(n)<=0||parseFloat(n)>a||!j||T,children:T?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):"Submit Withdrawal Request"})]})]}),e.jsx(G,{open:O,onOpenChange:p,children:e.jsxs(J,{children:[e.jsxs(K,{children:[e.jsx(Q,{children:"Discard Withdrawal Request?"}),e.jsx(X,{children:"Are you sure you want to go back? Your withdrawal details will not be saved."})]}),e.jsxs(Z,{children:[e.jsx(i,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(i,{variant:"destructive",onClick:()=>{p(!1),f("select-currency")},children:"Yes, Go Back"})]})]})})]})}return u==="confirmation"?e.jsx("div",{className:"container mx-auto py-8",children:e.jsxs(N,{className:"max-w-lg mx-auto",children:[e.jsxs(b,{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:e.jsx(te,{className:"h-6 w-6 text-green-600"})}),e.jsx(y,{className:"mt-4 text-xl",children:"Withdrawal Request Submitted"})]}),e.jsxs(g,{className:"text-center",children:[e.jsxs("p",{className:"text-gray-600 mb-4",children:["Your withdrawal request of"," ",x(n,t)," ",t," has been submitted and is pending approval."]}),e.jsx("p",{className:"text-gray-600",children:"You'll receive a notification once your withdrawal has been processed."})]}),e.jsxs(v,{className:"flex justify-center space-x-4",children:[e.jsx(i,{onClick:()=>o({to:"/dashboard/withdraw-history"}),children:"View Withdrawal History"}),e.jsx(i,{variant:"outline",onClick:()=>o({to:"/dashboard"}),children:"Return to Dashboard"})]})]})}):null};export{ue as component};
