import{e as y,j as e,c as j,ap as X,r as l,B as k,t as F,aq as Y}from"./index-BKI1WJFD.js";import{B as c}from"./badge-BJ3fx28W.js";import{T as ee,a as te,b as C,c as N,d as se,e as p}from"./table-B6S2DC1P.js";import{S as R,a as M,b as I,c as V,d as r}from"./select-B-3lH2JU.js";import{g as ae}from"./stats-DlNiH7IP.js";import{C as ne}from"./chevron-left-B9s_2PaO.js";import{C as re}from"./chevron-right-BvxBHhiI.js";import{L as _}from"./loader-circle-DVwTj61m.js";import{F as ie}from"./filter-B8QTzNSz.js";import{T as le}from"./trending-up-D6Tc_jHJ.js";import"./index-s_LgtPrL.js";import"./index-DlJsYnWQ.js";import"./chevron-down-9ebR-WP6.js";import"./check-BSI6iiZe.js";/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],oe=y("ArrowDown",ce);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],me=y("ArrowUp",de);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],he=y("FileDown",ue);/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],pe=y("RefreshCw",xe);function je({className:s,...a}){return e.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:j("mx-auto flex w-full justify-center",s),...a})}function ge({className:s,...a}){return e.jsx("ul",{"data-slot":"pagination-content",className:j("flex flex-row items-center gap-1",s),...a})}function L({...s}){return e.jsx("li",{"data-slot":"pagination-item",...s})}function T({className:s,isActive:a,size:w="icon",...o}){return e.jsx("a",{"aria-current":a?"page":void 0,"data-slot":"pagination-link","data-active":a,className:j(X({variant:a?"outline":"ghost",size:w}),s),...o})}function fe({className:s,...a}){return e.jsxs(T,{"aria-label":"Go to previous page",size:"default",className:j("gap-1 px-2.5 sm:pl-2.5",s),...a,children:[e.jsx(ne,{}),e.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function ve({className:s,...a}){return e.jsxs(T,{"aria-label":"Go to next page",size:"default",className:j("gap-1 px-2.5 sm:pr-2.5",s),...a,children:[e.jsx("span",{className:"hidden sm:block",children:"Next"}),e.jsx(re,{})]})}function Ne({userId:s}){const[a,w]=l.useState([]),[o,A]=l.useState([]),[b,S]=l.useState(!0),[O,B]=l.useState(0),[g,U]=l.useState("ALL"),[x,$]=l.useState("ALL"),[d,f]=l.useState(1),v=10,E=async()=>{try{S(!0);const t=await ae(s);w(t.transactions),A(t.transactions),B(t.total)}catch{F.error("Failed to fetch transaction history")}finally{S(!1)}};l.useEffect(()=>{let t=a;g!=="ALL"&&(t=t.filter(n=>n.status===g)),x!=="ALL"&&(t=t.filter(n=>n.type===x)),A(t),f(1)},[g,x,a]);const D=d*v,q=D-v,P=o.slice(q,D),u=Math.ceil(o.length/v),H=t=>new Date(t).toLocaleString(),z=(t,n)=>`${parseFloat(t).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:8})} ${n}`,G=(t,n)=>{if(n==="investment")switch(t){case"ACTIVE":return e.jsx(c,{className:"bg-green-500",children:"Active"});case"COMPLETED":return e.jsx(c,{className:"bg-blue-500",children:"Completed"});case"CANCELLED":return e.jsx(c,{variant:"destructive",children:"Cancelled"});case"PENDING":return e.jsx(c,{variant:"outline",className:"bg-yellow-100 text-yellow-800",children:"Pending"});default:return e.jsx(c,{variant:"outline",className:"bg-yellow-100 text-yellow-800",children:"Pending"})}switch(t){case"APPROVED":return e.jsx(c,{className:"bg-green-500",children:"Approved"});case"REJECTED":return e.jsx(c,{variant:"destructive",children:"Rejected"});case"FAILED":return e.jsx(c,{className:"bg-gray-500",children:"Failed"});default:return e.jsx(c,{variant:"outline",className:"bg-yellow-100 text-yellow-800",children:"Pending"})}},J=t=>{switch(t){case"deposit":return e.jsx(oe,{className:"h-4 w-4 text-green-500"});case"withdrawal":return e.jsx(me,{className:"h-4 w-4 text-red-500"});case"investment":return e.jsx(le,{className:"h-4 w-4 text-blue-500"});default:return null}},W=()=>{const n=[["Date","Type","Amount","Currency","Status"]];o.forEach(m=>{n.push([new Date(m.createdAt).toLocaleString(),m.type,m.amount,m.currency,m.status])});const i=n.map(m=>m.join(",")).join(`
`),K=new Blob([i],{type:"text/csv;charset=utf-8;"}),h=document.createElement("a"),Q=URL.createObjectURL(K);h.setAttribute("href",Q),h.setAttribute("download",`transactions_${s}_${new Date().toISOString().split("T")[0]}.csv`),h.style.visibility="hidden",document.body.appendChild(h),h.click(),document.body.removeChild(h),F.success("Transaction history exported successfully")},Z=()=>x==="investment"?e.jsxs(e.Fragment,{children:[e.jsx(r,{value:"ALL",children:"All Statuses"}),e.jsx(r,{value:"PENDING",children:"Pending"}),e.jsx(r,{value:"ACTIVE",children:"Active"}),e.jsx(r,{value:"COMPLETED",children:"Completed"}),e.jsx(r,{value:"CANCELLED",children:"Cancelled"})]}):e.jsxs(e.Fragment,{children:[e.jsx(r,{value:"ALL",children:"All Statuses"}),e.jsx(r,{value:"PENDING",children:"Pending"}),e.jsx(r,{value:"APPROVED",children:"Approved"}),e.jsx(r,{value:"REJECTED",children:"Rejected"}),e.jsx(r,{value:"FAILED",children:"Failed"})]});return l.useEffect(()=>{s&&E()},[s]),e.jsx("div",{className:"mx-5 lg:mx-10",children:e.jsxs("div",{className:"bg-sidebar rounded-lg shadow p-6 container mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Transaction History"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(k,{onClick:E,variant:"outline",disabled:b,className:"cursor-pointer",children:[b&&e.jsx(_,{className:"animate-spin h-4 w-4 mr-2"}),e.jsx("span",{children:e.jsx(pe,{className:"h-4 w-4 mr-2 md:hidden"})}),e.jsx("span",{className:"hidden md:inline",children:"Refresh"})]}),e.jsxs(k,{onClick:W,variant:"outline",className:"cursor-pointer",disabled:o.length===0,children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Export CSV"})]})]})]}),e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",o.length," of ",O," transactions"]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2 flex-col lg:flex-row",children:[e.jsx(ie,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(R,{value:x,onValueChange:$,children:[e.jsx(M,{className:"w-[150px]",children:e.jsx(I,{placeholder:"Type"})}),e.jsxs(V,{children:[e.jsx(r,{value:"ALL",children:"All Types"}),e.jsx(r,{value:"deposit",children:"Deposits"}),e.jsx(r,{value:"withdrawal",children:"Withdrawals"}),e.jsx(r,{value:"investment",children:"Investments"})]})]}),e.jsxs(R,{value:g,onValueChange:U,children:[e.jsx(M,{className:"w-[150px]",children:e.jsx(I,{placeholder:"Status"})}),e.jsx(V,{children:Z()})]})]})})]}),b?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(_,{className:"animate-spin",size:40})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ee,{children:[e.jsx(te,{children:e.jsxs(C,{children:[e.jsx(N,{children:"Date"}),e.jsx(N,{children:"Type"}),e.jsx(N,{children:"Amount"}),e.jsx(N,{children:"Status"})]})}),e.jsx(se,{children:P.length===0?e.jsx(C,{children:e.jsx(p,{colSpan:4,className:"text-center py-8",children:a.length===0?"No transactions found":"No transactions match your filter criteria"})}):P.map(t=>e.jsxs(C,{children:[e.jsx(p,{children:H(t.createdAt)}),e.jsx(p,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[J(t.type),e.jsx("span",{className:"capitalize",children:t.type})]})}),e.jsx(p,{className:"font-medium",children:z(t.amount,t.currency)}),e.jsx(p,{children:G(t.status,t.type)})]},t.id))})]})}),o.length>v&&e.jsx(je,{className:"mt-4",children:e.jsxs(ge,{children:[e.jsx(L,{children:e.jsx(fe,{onClick:()=>f(t=>Math.max(t-1,1)),className:d===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:Math.min(5,u)},(t,n)=>{let i;return u<=5||d<=3?i=n+1:d>=u-2?i=u-4+n:i=d-2+n,e.jsx(L,{children:e.jsx(T,{onClick:()=>f(i),isActive:d===i,className:"cursor-pointer",children:i})},i)}),e.jsx(L,{children:e.jsx(ve,{onClick:()=>f(t=>Math.min(t+1,u)),className:d===u?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})]})})}const Me=function(){const{user:a}=Y.useLoaderData();return e.jsx(Ne,{userId:a.id})};export{Me as component};
