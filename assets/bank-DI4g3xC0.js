import{r as t,j as e,B as o,X as B,t as c}from"./index-BVlH3n0h.js";import{B as b}from"./badge-CiDXrPHU.js";import{D as I,a as H,b as V,c as q,d as z}from"./dialog-DFNuYmcJ.js";import{T as O,a as G,b as y,c as l,d as J,e as r}from"./table-C0X7gbyH.js";import{I as Q}from"./input-B1UDhOgi.js";import{S as $,a as U,b as X,c as K,d as p}from"./select-C4fw0IIL.js";import{b as M,c as Y,r as Z}from"./withdrawal-bank-zQ-2gD3H.js";import{S as _}from"./search-3wBS_qrE.js";import{F as ee}from"./filter-BnCwasT0.js";import{L as se}from"./loader-circle-CnBdTBbm.js";import{C as te}from"./check-BGrFiPcB.js";import"./index-gNPglWqf.js";import"./index-Tt_Gk8TM.js";import"./chevron-down-CXltBhww.js";function ae(){const[d,R]=t.useState([]),[S,C]=t.useState([]),[g,w]=t.useState(!0),[n,u]=t.useState(null),[N,A]=t.useState(""),[v,m]=t.useState(null),[D,x]=t.useState(!1),[h,E]=t.useState(""),[j,L]=t.useState("ALL"),f=async()=>{try{w(!0);const s=await M();R(s),C(s)}catch{c.error("Failed to fetch withdrawals data")}finally{w(!1)}};t.useEffect(()=>{let s=d;if(h){const a=h.toLowerCase();s=s.filter(i=>i.user.name.toLowerCase().includes(a)||i.user.email.toLowerCase().includes(a))}j!=="ALL"&&(s=s.filter(a=>a.status===j)),C(s)},[h,j,d]);const k=async s=>{m(s);try{await Y(s),c.success("Withdrawal approved successfully"),f()}catch{c.error("Failed to approve withdrawal")}finally{m(null)}},F=async(s,a)=>{if(!a.trim()){c.error("Rejection reason is required");return}m(s);try{const i=a.trim();await Z(s,i),c.success("Withdrawal rejected successfully"),f(),x(!1),u(null)}catch{c.error("Failed to reject withdrawal")}finally{m(null)}},W=s=>new Date(s).toLocaleString(),P=(s,a)=>`${parseFloat(s).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:8})} ${a}`,T=s=>{switch(s){case"APPROVED":return e.jsx(b,{className:"bg-green-500",children:"Approved"});case"REJECTED":return e.jsx(b,{variant:"destructive",children:"Rejected"});default:return e.jsx(b,{variant:"outline",className:"bg-yellow-100 text-yellow-800",children:"Pending"})}};return t.useEffect(()=>{f()},[]),e.jsxs("div",{className:"container mx-auto py-6 md:w-[90%] lg:w-[85%] px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Bank Withdrawals Administration"})," ",e.jsx(o,{onClick:f,disabled:g,className:"cursor-pointer",children:g?"Loading...":"Refresh"})]}),e.jsxs("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("div",{className:"flex items-center gap-2 w-full md:w-1/2",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx(_,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(Q,{placeholder:"Search by name or email",value:h,onChange:s=>E(s.target.value),className:"pl-8 w-full"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs($,{value:j,onValueChange:L,children:[e.jsx(U,{className:"w-[180px]",children:e.jsx(X,{placeholder:"Filter by Status"})}),e.jsxs(K,{children:[e.jsx(p,{value:"ALL",children:"All Statuses"}),e.jsx(p,{value:"PENDING",children:"Pending"}),e.jsx(p,{value:"APPROVED",children:"Approved"}),e.jsx(p,{value:"REJECTED",children:"Rejected"})]})]})]})]}),g?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(se,{className:"animate-spin",size:40})}):e.jsx("div",{className:"bg-sidebar rounded-lg shadow overflow-hidden",children:e.jsxs(O,{children:[e.jsx(G,{children:e.jsxs(y,{children:[e.jsx(l,{children:"User"}),e.jsx(l,{children:"Email"}),e.jsx(l,{children:"Bank Name"}),e.jsx(l,{children:"Account Name"}),e.jsx(l,{children:"Account Number"}),e.jsx(l,{children:"Amount"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Date"}),e.jsx(l,{className:"text-right",children:"Actions"})]})}),e.jsx(J,{children:S.length===0?e.jsx(y,{children:e.jsx(r,{colSpan:9,className:"text-center py-8",children:d.length===0?"No withdrawals found":"No withdrawals match your search criteria"})}):S.map(s=>e.jsxs(y,{children:[e.jsx(r,{className:"font-medium",children:s.user.name||s.user.id.substring(0,8)+"..."}),e.jsx(r,{className:"text-sm text-muted-foreground",children:s.user.email}),e.jsx(r,{className:"text-sm",children:s.bankName}),e.jsx(r,{className:"text-sm",children:s.bankAccountName}),e.jsx(r,{className:"font-mono text-sm",children:s.bankAccountNumber}),e.jsx(r,{children:P(s.amount,s.currency)}),e.jsx(r,{children:T(s.status)}),e.jsx(r,{children:W(s.createdAt)}),e.jsx(r,{className:"text-right",children:e.jsx("div",{className:"flex justify-end gap-2",children:s.status==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsxs(o,{variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700 cursor-pointer",onClick:()=>k(s.id),disabled:v===s.id,children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs(o,{variant:"destructive",size:"sm",className:"cursor-pointer",onClick:()=>{u(s),A(""),x(!0)},disabled:v===s.id,children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"Reject"]})]})})})]},s.id))})]})}),e.jsx(I,{open:!!n&&D,onOpenChange:s=>{s||(u(null),x(!1))},children:e.jsxs(H,{children:[e.jsxs(V,{children:[e.jsx(q,{children:"Reject Withdrawal"}),e.jsx(z,{children:"Please provide a reason for rejecting this withdrawal request."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsx("textarea",{className:"min-h-[100px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",placeholder:"Enter rejection reason...",value:N,onChange:s=>A(s.target.value)})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{className:"cursor-pointer",variant:"outline",onClick:()=>{u(null),x(!1)},children:"Cancel"}),e.jsx(o,{className:"cursor-pointer",variant:"destructive",onClick:()=>{n&&F(n.id,N)},disabled:!N.trim()||v===(n==null?void 0:n.id),children:"Confirm Rejection"})]})]})})]})}const ge=function(){return e.jsx(ae,{})};export{ge as component};
