import{r as l,j as e,B as m,u as H,L as C,az as J,t as L}from"./index-BKI1WJFD.js";import{a as M}from"./withdrawal-cashapp-CZVPBbZ5.js";import{C as g,a as w,b as y,c as D,d as N,e as b}from"./card-D2tBPcb5.js";import{I as S}from"./input-COXMr8KZ.js";import{L as A}from"./label-pumfUz_W.js";import{F as V,a as G}from"./form-success-D94Keyl1.js";import{L as q}from"./loader-circle-DVwTj61m.js";import{A as K}from"./arrow-right-BG38eTkz.js";import{C as W}from"./chevron-left-B9s_2PaO.js";import{C as Q}from"./check-BSI6iiZe.js";import"./circle-alert-1X7729Uh.js";function X({balanceToWithdrawFrom:a,onFormSubmit:v,isParentSubmitting:i}){const[t,r]=l.useState({tag:"",name:"",amount:""}),[o,d]=l.useState(""),[x,u]=l.useState(""),p=async n=>{if(n.preventDefault(),i)return;if(d(""),u(""),!t.tag.startsWith("$")||t.tag.length<=1)return d("Enter a valid Cash Tag (e.g., $yourtag).");if(t.name.trim()==="")return d("Enter a valid Name.");const f=Number(t.amount);if(t.amount===""||isNaN(f)||f<=0)return d("Enter a valid Amount.");if(a&&f>a.amountUSD)return d(`Withdrawal amount exceeds your available ${a.currency} balance of $${a.amountUSD.toFixed(2)}.`);v(t)};return e.jsxs(g,{className:"w-full max-w-sm",children:[e.jsxs(w,{children:[e.jsx(y,{children:"Cash App Withdrawal"}),a?e.jsxs(D,{children:["Withdraw from your ",a.currency," balance (",`$${a.amountUSD.toFixed(2)}`,") via Cash App. Enter your Cash Tag, Name, and desired Amount in USD below."]}):e.jsx(D,{children:"Enter your Cash Tag, Name and Desired Amount in USD below to withdraw funds."})]}),e.jsx(N,{children:e.jsxs("form",{onSubmit:p,children:[e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(A,{htmlFor:"tag",children:"Cash App Tag"}),e.jsx(S,{value:t.tag,onChange:n=>r({...t,tag:n.target.value}),id:"tag",type:"text",placeholder:"$cashtag",required:!0,disabled:i})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(A,{htmlFor:"name",children:"Full Name on Cash App"}),e.jsx(S,{value:t.name,onChange:n=>r({...t,name:n.target.value}),id:"name",type:"text",placeholder:"John Doe",required:!0,disabled:i})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(A,{htmlFor:"amount",children:"Amount (USD)"}),e.jsx(S,{value:t.amount,onChange:n=>r({...t,amount:n.target.value}),id:"amount",type:"number",placeholder:"100.00",min:"0.01",step:"0.01",required:!0,disabled:i}),a&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Available to withdraw from ",a.currency,": $",a.amountUSD.toFixed(2)]})]})]}),e.jsx("br",{}),e.jsx(V,{message:o}),e.jsx(G,{message:x})]})}),e.jsx(b,{className:"flex-col gap-2",children:e.jsx(m,{type:"submit",className:"w-full",disabled:i,onClick:n=>p(n),children:i?e.jsx(q,{className:"w-4 h-4 animate-spin"}):"Request Withdrawal"})})]})}const Z=({currency:a})=>{switch(a){case"BTC":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-orange-500 flex items-center justify-center text-white font-bold",children:"₿"});case"ETH":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-purple-700 flex items-center justify-center text-white font-bold",children:"Ξ"});case"USDT":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-600 flex items-center justify-center text-white font-bold",children:"₮"});case"SOL":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-bold",children:"◎"});case"BNB":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-yellow-500 flex items-center justify-center text-white font-bold",children:"B"});case"LTC":return e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-500 flex items-center justify-center text-white font-bold",children:"Ł"});default:return e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-300 flex items-center justify-center",children:"?"})}},oe=function(){const v=H(),[i,t]=l.useState(!0),[r,o]=l.useState(null),[d,x]=l.useState("select-crypto-source"),[u,p]=l.useState(null),[n,f]=l.useState({}),[T,B]=l.useState(!1),[U,R]=l.useState([]),[j,F]=l.useState(null);l.useEffect(()=>{(async()=>{try{t(!0),o(null);const c=await J(),h=Object.entries(c).reduce(($,[O,Y])=>($[O]=parseFloat(Y)||0,$),{});f(h);const E=Object.keys(h);R(E),E.length===0&&o("You do not have any crypto balances to withdraw from.")}catch(c){console.error("Failed to load balances:",c),o("Failed to load your crypto balances. Please try again later.")}finally{t(!1)}})()},[]);const I=(s,c)=>{p({currency:s,amountUSD:c}),x("enter-cashapp-details")},z=async s=>{if(!u){o("No crypto source selected. Please go back.");return}B(!0),o(null);try{await M(u.currency,parseFloat(s.amount),s.tag,s.name),F({sourceCurrency:u.currency,amountUSD:s.amount,cashAppTag:s.tag,cashAppName:s.name}),L.success("Cash App withdrawal request submitted successfully!"),x("confirmation")}catch(c){console.error("Cash App withdrawal error:",c),o("An error occurred while processing your Cash App withdrawal. Please try again."),L.error("Failed to submit Cash App withdrawal request.")}finally{B(!1)}},k=s=>s.toFixed(2);return i?e.jsx("div",{className:"flex h-full min-h-96 items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(q,{className:"mx-auto h-8 w-8 animate-spin text-primary"}),e.jsx("p",{className:"mt-2 text-lg",children:"Loading your balances..."})]})}):r&&d!=="enter-cashapp-details"?e.jsx("div",{className:"flex h-full min-h-96 items-center justify-center",children:e.jsxs(g,{className:"w-full max-w-md",children:[e.jsx(w,{className:"bg-red-50 text-red-700",children:e.jsx(y,{children:"Error"})}),e.jsx(N,{className:"pt-6",children:e.jsx("p",{children:r})}),e.jsx(b,{children:e.jsx(m,{onClick:()=>window.location.reload(),children:"Try Again"})})]})}):U.length===0&&!i&&!r?e.jsxs("div",{className:"container py-8 mx-auto text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Withdraw via Cash App"}),e.jsx("p",{className:"text-xl text-gray-600 text-center",children:"You currently have no crypto balances to withdraw from using Cash App."}),e.jsxs("p",{className:"mt-4",children:[e.jsx(C,{to:"/dashboard/deposit",className:"text-primary hover:underline",children:"Deposit funds"})," ","or"," ",e.jsx(C,{to:"/dashboard",className:"text-primary hover:underline",children:"return to dashboard"}),"."]})]}):d==="select-crypto-source"?e.jsxs("div",{className:"container py-8 mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2 text-center",children:"Withdraw via Cash App"}),e.jsx("p",{className:"text-gray-600 mb-8 text-center",children:"Select the crypto balance you wish to withdraw funds from. The selected amount will be converted to USD and sent to your Cash App."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl mx-auto",children:U.map(s=>{const c=n[s]||0,h=c>.009;return h?e.jsxs(g,{className:`hover:shadow-md transition-shadow ${h?"cursor-pointer":"opacity-60"}`,onClick:()=>h&&I(s,c),children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Z,{currency:s}),e.jsx(y,{children:s})]})}),e.jsx(N,{children:e.jsxs(D,{children:["Available Balance (USD):"," ",e.jsxs("span",{className:"font-semibold",children:["$",k(c)]})]})}),e.jsx(b,{className:"pt-0",children:h?e.jsxs(m,{variant:"ghost",className:"ml-auto",size:"sm",children:["Select & Continue ",e.jsx(K,{className:"ml-2 h-4 w-4"})]}):e.jsx(m,{variant:"outline",size:"sm",className:"ml-auto",disabled:!0,children:"Insufficient Balance"})})]},s):null})}),e.jsx("div",{className:"mt-12 text-center",children:e.jsx(C,{to:"/dashboard/withdraw",children:e.jsxs(m,{variant:"outline",children:[e.jsx(W,{className:"mr-2 h-4 w-4"})," Back to Withdrawal Options"]})})})]}):d==="enter-cashapp-details"&&u?e.jsxs("div",{className:"container py-8 mx-auto flex flex-col items-center",children:[e.jsx("div",{className:"w-full max-w-sm mb-6",children:e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>{o(null),x("select-crypto-source")},children:[e.jsx(W,{className:"mr-2 h-4 w-4"})," Back to Select Balance"]})}),e.jsx(X,{balanceToWithdrawFrom:u,onFormSubmit:z,isParentSubmitting:T}),r&&e.jsx("p",{className:"mt-4 text-sm text-red-600 text-center",children:r})]}):d==="confirmation"&&j?e.jsx("div",{className:"container mx-auto py-8",children:e.jsxs(g,{className:"max-w-lg mx-auto",children:[e.jsxs(w,{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-green-100",children:e.jsx(Q,{className:"h-6 w-6 text-green-600"})}),e.jsx(y,{className:"mt-4 text-xl",children:"Cash App Withdrawal Request Submitted"})]}),e.jsxs(N,{className:"text-center space-y-3",children:[e.jsxs("p",{className:"text-gray-700",children:["Your request to withdraw"," ",e.jsxs("span",{className:"font-semibold",children:["$",k(parseFloat(j.amountUSD))]})," ","from your"," ",e.jsx("span",{className:"font-semibold",children:j.sourceCurrency})," ","balance to CashApp user"," ",e.jsx("span",{className:"font-semibold",children:j.cashAppTag})," ","(",j.cashAppName,") has been submitted."]}),e.jsx("p",{className:"text-gray-600 text-sm",children:"This will be processed shortly. For now, the details have been logged to the console."}),r&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:r})]}),e.jsxs(b,{className:"flex flex-col sm:flex-row justify-center space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsx(m,{onClick:()=>{x("select-crypto-source"),p(null),F(null),o(null)},children:"Make Another Cash App Withdrawal"}),e.jsx(m,{variant:"outline",onClick:()=>v({to:"/dashboard"}),children:"Return to Dashboard"})]})]})}):!i&&!r?e.jsxs("div",{className:"container py-8 mx-auto text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Cash App Withdrawal"}),e.jsx("p",{children:"Something went wrong, or there are no balances available."}),e.jsx(m,{onClick:()=>window.location.reload(),className:"mt-4",children:"Try Again"})]}):null};export{oe as component};
