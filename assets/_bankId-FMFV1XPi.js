import{r,j as e,B as C,a_ as D}from"./index-Caxnq4fP.js";import{d as w,u as P}from"./bank-C1XVi6Q_.js";import{D as E,f as S,a as L,b as R,c as F,d as U,e as B}from"./dialog-YHpiP2M3.js";import{I as k}from"./input-9dZTne-k.js";import{L as a}from"./label-CnkdeUHA.js";import{F as I,a as T}from"./form-success-DjkpuRcg.js";import{B as j}from"./badge-CH4Itv7g.js";import{C as g,a as N,b as y,d as v,c as O,e as $}from"./card-BMh53kiZ.js";import{L as _}from"./loader-circle-CEWipKhR.js";import"./circle-alert-BlkNPLzr.js";import"./check-PSB7j7kI.js";const G="https://api.ecohavest.org/api/deposit/bank/images/",H=({bankId:i})=>{const[s,d]=r.useState(null),[o,l]=r.useState(!0),[m,c]=r.useState(null),x=async()=>{l(!0),c(null);try{const t=await w(i);d(t)}catch(t){c(t instanceof Error?t.message:"Failed to fetch deposit details.")}finally{l(!1)}};r.useEffect(()=>{x()},[i]);const n=t=>new Date(t).toLocaleString(),u=t=>`$${parseFloat(t).toFixed(2)}`,p=t=>{switch(t){case"APPROVED":case"ACTIVE":case"COMPLETED":return e.jsx(j,{className:"bg-green-500 text-white px-3 py-1 text-sm",children:t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()});case"REJECTED":case"FAILED":case"CANCELLED":return e.jsx(j,{variant:"destructive",className:"px-3 py-1 text-sm",children:t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()});case"PROCESSING":return e.jsx(j,{className:"bg-blue-500 text-white px-3 py-1 text-sm",children:t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()});default:return e.jsx(j,{variant:"outline",className:"bg-yellow-100 text-yellow-800 px-3 py-1 text-sm",children:t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()})}};return o?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(_,{className:"animate-spin text-primary",size:40})}):m?e.jsxs(g,{className:"max-w-2xl mx-auto mt-8",children:[e.jsx(N,{children:e.jsx(y,{className:"text-red-500",children:"Error"})}),e.jsxs(v,{children:[e.jsx("p",{children:m}),e.jsx(C,{onClick:x,className:"mt-4",children:"Try Again"})]})]}):s?e.jsx("div",{className:"container mx-auto py-6 md:w-[90%] lg:w-[70%] px-4",children:e.jsxs(g,{className:"w-full",children:[e.jsx(N,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(y,{className:"text-2xl font-bold mb-1",children:"Bank Deposit Details"}),e.jsxs(O,{children:["Transaction ID: ",s.id]})]}),p(s.status)]})}),e.jsxs(v,{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Amount"}),e.jsx("p",{className:"text-lg font-semibold",children:u(s.amount)})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Bank Name"}),e.jsx("p",{className:"text-lg",children:s.bankName})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Bank Account Name"}),e.jsx("p",{className:"text-lg",children:s.bankAccountName||"N/A"})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Bank Account Number"}),e.jsx("p",{className:"text-lg",children:s.bankAccountNumber||"N/A"})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Date Created"}),e.jsx("p",{className:"text-lg",children:n(s.createdAt)})]}),e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Last Updated"}),e.jsx("p",{className:"text-lg",children:n(s.updatedAt)})]}),s.approvedAt&&e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Approved At"}),e.jsx("p",{className:"text-lg",children:n(s.approvedAt)})]}),s.rejectedAt&&e.jsxs("div",{children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Rejected At"}),e.jsx("p",{className:"text-lg",children:n(s.rejectedAt)})]})]}),s.rejectionReason&&e.jsxs("div",{className:"mt-2",children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Rejection Reason"}),e.jsx("p",{className:"text-lg text-red-600",children:s.rejectionReason})]}),s.paymentProof&&e.jsxs("div",{className:"mt-2",children:[e.jsx(a,{className:"text-sm font-medium text-muted-foreground",children:"Payment Proof"}),e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:`${G}${s.paymentProof}`,alt:"Payment proof",className:"max-w-xs rounded-lg border shadow-md"})})]})]}),e.jsx($,{className:"flex justify-end",children:s.status==="PENDING"&&e.jsx(V,{bankId:i})})]})}):e.jsxs(g,{className:"max-w-2xl mx-auto mt-8",children:[e.jsx(N,{children:e.jsx(y,{children:"Not Found"})}),e.jsx(v,{children:e.jsx("p",{children:"Deposit details could not be found."})})]})},V=({bankId:i})=>{const[s,d]=r.useState(null),[o,l]=r.useState(),[m,c]=r.useState(),[x,n]=r.useState(),[u,p]=r.useState(!1);async function t(){if(!s){c("Please upload a proof of payment");return}p(!0),c(void 0),n(void 0);try{await P(i,s),n("Payment proof uploaded successfully"),window.location.reload()}catch(h){c(h instanceof Error?h.message:"An error occurred")}finally{p(!1)}}r.useEffect(()=>()=>{o&&URL.revokeObjectURL(o)},[o]);const A=h=>{var b;const f=(b=h.target.files)==null?void 0:b[0];f?(d(f),l(URL.createObjectURL(f))):(d(null),l(void 0))};return e.jsxs(E,{children:[e.jsx(S,{asChild:!0,children:e.jsx(C,{children:"Upload Payment Proof"})}),e.jsxs(L,{children:[e.jsxs(R,{children:[e.jsx(F,{children:"Upload Payment Proof"}),e.jsx(U,{children:"Please upload a screenshot or image of your payment confirmation."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(a,{htmlFor:"payment-proof",className:"text-right",children:"Screenshot"}),e.jsx(k,{id:"payment-proof",type:"file",accept:"image/*",onChange:A,className:"col-span-3"})]}),o&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx("img",{src:o,alt:"Payment proof preview",className:"max-w-[300px] rounded-lg border"})})]}),e.jsx(I,{message:m}),e.jsx(T,{message:x}),e.jsx(B,{children:e.jsx(C,{onClick:t,"aria-label":"Upload payment proof",type:"submit",disabled:u,children:u?"Submitting...":"Submit"})})]})]})},se=function(){const{bankId:s}=D.useParams();return e.jsx(H,{bankId:s})};export{se as component};
