import{b as T,aT as E,r as S,u as N,z as d,j as e,B as R}from"./index-IWioU4ds.js";import{u as I,s as k,F as w,a as m,b as u,c as p,d as x,e as f,f as L,g as P}from"./form-success-CPMMY8m9.js";import{I as y}from"./input-CwM7oT_a.js";import{S as V,a as A,b as K,c as O,d as h}from"./select-D5Vvh5jn.js";import{A as Y}from"./accent-card-Bcq2eRfo.js";import{L as _}from"./loader-circle-BBFtkxRH.js";import"./label-lg737-6N.js";import"./circle-alert-B4er0ovv.js";import"./check-BoSMEAlx.js";import"./index-2LfrzjyB.js";import"./index-C3fpgkxS.js";import"./chevron-down-C4vffeeG.js";import"./card-r_43QZ7w.js";import"./proxy-NP41z5tj.js";const q=async(b,i,a,j,g)=>{const t=new FormData;return t.append("front",b),t.append("back",i),t.append("selfie",a),t.append("documentType",j),t.append("userId",g),(await T.post("https://api.ecohavest.org/api/kyc/upload",t,{withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}})).data},B=d.object({front:d.instanceof(File,{message:"Front image is required"}),back:d.instanceof(File,{message:"Back image is required"}),selfie:d.instanceof(File,{message:"Selfie image is required"}),documentType:d.enum(["ID_CARD","DRIVERS_LICENSE","PASSPORT","OTHER"],{required_error:"Please select a document type"})}),ae=function(){const{user:i}=E.useLoaderData(),[a,j]=S.useTransition(),[g,t]=S.useState(),[C,v]=S.useState(),F=N(),n=I({resolver:k(B),defaultValues:{front:void 0,back:void 0,selfie:void 0,documentType:void 0}});function D(s){t(void 0),v(void 0),j(async()=>{if(!i||!i.id)throw new Error("User not found");try{await q(s.front,s.back,s.selfie,s.documentType,i.id),v("KYC documents uploaded successfully"),F({to:"/dashboard/account/kyc/pending"})}catch(o){t(o instanceof Error?o.message:"Failed to upload KYC documents")}})}return e.jsx("div",{className:"container max-w-2xl py-6 mx-auto",children:e.jsx(Y,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"KYC Verification"}),e.jsx("p",{className:"text-balance text-muted-foreground",children:"Upload your identity documents for verification"}),e.jsx("p",{className:"text-balance text-muted-foreground",children:"Upgrade your account to unlock full feature and increase your limit of transaction amount."})]}),e.jsx(w,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(D),className:"space-y-6",children:[e.jsx(m,{control:n.control,name:"documentType",disabled:a,render:({field:s})=>e.jsxs(u,{children:[e.jsx(p,{children:"Document Type"}),e.jsxs(V,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(x,{children:e.jsx(A,{children:e.jsx(K,{placeholder:"Select document type"})})}),e.jsxs(O,{children:[e.jsx(h,{value:"ID_CARD",children:"ID Card"}),e.jsx(h,{value:"DRIVERS_LICENSE",children:"Driver's License"}),e.jsx(h,{value:"PASSPORT",children:"Passport"}),e.jsx(h,{value:"OTHER",children:"Other"})]})]}),e.jsx(f,{})]})}),e.jsx(m,{control:n.control,name:"front",disabled:a,render:({field:{value:s,onChange:o,...c}})=>e.jsxs(u,{children:[e.jsx(p,{children:"Front of Document"}),e.jsx(x,{children:e.jsx(y,{type:"file",accept:"image/*",onChange:l=>{var r;return o((r=l.target.files)==null?void 0:r[0])},...c})}),e.jsx(f,{})]})}),e.jsx(m,{control:n.control,name:"back",disabled:a,render:({field:{value:s,onChange:o,...c}})=>e.jsxs(u,{children:[e.jsx(p,{children:"Back of Document"}),e.jsx(x,{children:e.jsx(y,{type:"file",accept:"image/*",onChange:l=>{var r;return o((r=l.target.files)==null?void 0:r[0])},...c})}),e.jsx(f,{})]})}),e.jsx(m,{control:n.control,name:"selfie",disabled:a,render:({field:{value:s,onChange:o,...c}})=>e.jsxs(u,{children:[e.jsx(p,{children:"Selfie with Document"}),e.jsx(x,{children:e.jsx(y,{type:"file",accept:"image/*",onChange:l=>{var r;return o((r=l.target.files)==null?void 0:r[0])},...c})}),e.jsx(f,{})]})}),e.jsx(L,{message:g}),e.jsx(P,{message:C}),e.jsx(R,{disabled:a,type:"submit",className:"w-full",children:a?e.jsx(_,{className:"h-4 w-4 animate-spin"}):"Submit KYC Documents"})]})})]})})})};export{ae as component};
